// First add these imports at the top
import { adminLogin } from './auth-utils';
import { verifyPassword } from './utils/password-utils';

// Then replace the admin login route with:
  app.post("/api/auth/login", adminLogin);

// Replace the password verification in the auth/reset-password route:
      // Check current password
      let passwordMatch = false;
      try {
        passwordMatch = await verifyPassword(currentPassword, user.password || '');
      } catch (error) {
        return res.status(500).json({ message: "Error verifying password" });
      }
      
      if (!passwordMatch) {
        return res.status(401).json({ message: "Current password is incorrect" });
      }

// Replace password verification in the /api/users/change-password route:
      // Check if current password is correct using secure verification
      let passwordMatch = false;
      try {
        passwordMatch = await verifyPassword(currentPassword, currentUser.password);
      } catch (error) {
        return res.status(500).json({ message: "Error verifying password" });
      }
      
      if (!passwordMatch) {
        return res.status(400).json({ message: "Current password is incorrect" });
      }